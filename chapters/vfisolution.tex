\section{Value Function Iteration solution}

As described in the section XXX, I first try to solve the model by Value Function iteration:

\subsubsection{Evaluating the Expectation of the next-period value function}

\begin{equation}
    \E_{t}[v_{t+1}(M_{t+1}, W_{t+1}, K_{t+1}, Q_{t+1})] = \int_{\epsilon_{t+1}} \int_{\psi_{t+1}} v_{t+1} (M_{t+1}, W_{t+1}, K_{t+1}, Q_{t+1}) d \psi_{t+1}  d \epsilon_{t+1}
\end{equation}

I solve this by discretizing over the space of the vector of random variables $(\epsilon, \psi)$. Consider first that $\epsilon$ which is normally distributed. Gauss-Hermite integration allows for efficient integration over such stochastic variable. Since $\psi$ is discrete $[0,1]$ it obviously lends it self for easy integration. However since $w_j$ is the equal to $p_{\psi}$, it should be noted that it's dependent on the age of the agent. 

\begin{equation}
    \E_{t}[v_{t+1}(M_{t+1}, W_{t+1}, K_{t+1}, Q_{t+1})] =  \sum_{i=1}^{N_{GH}} \sum_{j=0}^{1} w_{i}^{\epsilon} w_{j}^{\psi}  \cdot v_{t+1} (M_{t+1}, W_{t+1}, K_{t+1}, Q_{t+1}) 
\end{equation}    

\subsubsection{Solving the model}

I initialize the model in the terminating period $Q=60$. Since, the model moves in a deterministic fashion (with regards to age), I can bootstrap on age, also referred to as backward induction in other literature.

I first create a grid over the state space: 

\begin{equation}
    \textbf{State grid } (Q, K, Z, G) = \{18, 19, \cdots, 60\} \times \{0, 1 \cdots 5\} \times \{-200, - 175, \cdots, 200 \} \times \{0.0, 0.5, \cdots,  6\} 
\end{equation}

which imply a grid-space of size $42 \times 6 \times 17 \times 13 = 55692$. Where we start at the terminal period or in other words we start in the end where $Q=60$. 


\begin{algorithm}[H]
\SetAlgoLined
\KwResult{$\pi^*(s_t)$ and $v^{*}(s_t)$ }
  $v^{*}(s_t) = - \infty$\;
  $\pi^*(s_t) = \textbf{null}$\;
 \For{$h \in \actionspace$ }{
  $v = U_t + \gamma \E[v(S_{t+1})]$\;
  \If{$v > v^{*}(s_t)$}{
   $\pi^{*}(s_t) = h$\;
   $v^*(s_t) = v$\;
   }
 }
 \caption{Solving for optimal choices for a given state $s_t$}
\end{algorithm}

So for a given state $s_t=(q_t, k_t, g_t, z_t)$ (note lower case since it's a realization) we can find the corresponding $v^*(s_t)$ and policy $\pi^*(s_t)$. Now considering the expression $\E [v(S_t)]$ implies that the value function for $v(S_{t+1})$ exists. Therefore, we solve the model from the terminal period $Q=60$. This will yield $v(s_t) = U_t$, and so next we can solve the model for $Q=59$ etc.

